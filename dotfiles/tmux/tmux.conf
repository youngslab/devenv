# Terminal settings
set -g default-terminal "xterm-256color"
set -ga terminal-overrides ",xterm-256color:Tc"

# OSC 52 clipboard support (allow copying to system clipboard)
set -g set-clipboard on
set -g allow-passthrough on
set -as terminal-features ',xterm-256color:clipboard'

# Default shell
set -g default-shell /usr/bin/zsh

# Status bar colors (tmux 3.0+ syntax)
set -g status-style bg=black,fg=yellow

# Window status colors
set -g window-status-style fg=brightblue,bg=default
set -g window-status-current-style fg=brightred,bg=default

# Pane border colors
set -g pane-border-style fg=black
set -g pane-active-border-style fg=brightgreen

# Message colors
set -g message-style bg=black,fg=brightred

# Pane number display
set -g display-panes-active-colour blue
set -g display-panes-colour brightred

# Clock
set -g clock-mode-colour green

# -----------------------------------------
# Key Bindings
# -----------------------------------------

# Pane selection (vim style with prefix)
bind h select-pane -L
bind j select-pane -D
bind k select-pane -U
bind l select-pane -R

# Vim copy mode
setw -g mode-keys vi
bind-key -T copy-mode-vi 'v' send -X begin-selection
bind-key -T copy-mode-vi 'V' send -X select-line
bind-key -T copy-mode-vi 'r' send -X rectangle-toggle
# copy-selection uses OSC 52 via set-clipboard on
bind-key -T copy-mode-vi 'y' send -X copy-selection-and-cancel

# Window selection (Alt+number)
bind-key -n M-1 select-window -t :1
bind-key -n M-2 select-window -t :2
bind-key -n M-3 select-window -t :3
bind-key -n M-4 select-window -t :4
bind-key -n M-5 select-window -t :5
bind-key -n M-6 select-window -t :6
bind-key -n M-7 select-window -t :7
bind-key -n M-8 select-window -t :8
bind-key -n M-9 select-window -t :9

# Window reordering (Ctrl+Shift+Arrow)
bind-key -n C-S-Left swap-window -t -1\; select-window -t -1
bind-key -n C-S-Right swap-window -t +1\; select-window -t +1

# Pane movement (Alt+hjkl, only if not zoomed)
is_zoomed="tmux list-panes -F '#F' | grep -q Z"
bind-key -n M-l if-shell "$is_zoomed" "" "select-pane -R"
bind-key -n M-h if-shell "$is_zoomed" "" "select-pane -L"
bind-key -n M-j if-shell "$is_zoomed" "" "select-pane -D"
bind-key -n M-k if-shell "$is_zoomed" "" "select-pane -U"

# Zoom toggle
bind-key -n M-z resize-pane -Z

# -----------------------------------------
# General Settings
# -----------------------------------------

# History limit
set -g history-limit 100000

# Index starts at 1
set -g base-index 1
setw -g pane-base-index 1

# Renumber windows when one is closed
set -g renumber-windows on

# Faster escape time
set -sg escape-time 0

# Extended keys (CSI u format for iTerm2 compatibility)
# Fixes Ctrl+P delay issue in tmux
# Requires tmux 3.5+ for extended-keys-format
# See: https://medium.com/@andrejkurocenko/why-ctrl-stopped-working-when-i-switched-to-tmux-72b6345a1301
set -s extended-keys on
set -as terminal-features 'xterm*:extkeys'
set -g extended-keys-format csi-u

# -----------------------------------------
# Bell / Notification Settings
# -----------------------------------------

# Monitor bell in other windows (for Claude Code notifications)
set -g monitor-bell on
set -g bell-action other

# Bell style - highlight window tab when bell rings
set -g window-status-bell-style fg=black,bg=brightyellow,bold

# Message display time (4 seconds)
set -g display-time 4000

# Enable mouse (uncomment if needed)
# set -g mouse on
